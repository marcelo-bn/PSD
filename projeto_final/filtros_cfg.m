clear all; close all; clc;

%% Dados gerais

f1 = 1200; f2 = 2000; f3 = 3000; 
f4 = 3800; fa = 8000; fN = fa/2;

A0 = 0; Ap = 3; As = 40; Apa = Ap/2;

Gtopo = 20; Gp = 17; Gs = -20;
Gtopo2 = 1; Gp2 = -2; Gs2 = -39;
Gtopo3 = 0; Gp3 = -3; Gs3 = -40;

fs1 = f1; fp1 = f2; fp2 = f3; fs2 = f4;
f = [fs1 fp1 fp2 fs2];

ws1 = fs1/fN; wp1 = fp1/fN; 
wp2 = fp2/fN; ws2 = fs2/fN;

%% Desenvolvimento FIR BP Parks-McClellan

% Mascara 
fv = [0 ws1 ws1 ws2 ws2 1 1 wp2 wp2 wp1 wp1];
Amin_a = -Gs+100;
mv = [Gs Gs Gtopo Gtopo Gs Gs -Amin_a -Amin_a Gp Gp -Amin_a];

n_fir = 15;
w = [5 1 5]';

FIR_coeff = [0.276784850536256 -0.468249447094867 -0.0181458335529196 -0.0579194055369870 0.808711927137104 0.514373785443998 -3.30154223899505 2.20774610833569 2.20774610833569 -3.30154223899505 0.514373785443998 0.808711927137104 -0.0579194055369870 -0.0181458335529196 -0.468249447094867 0.276784850536256];

%% Desenvolvimento IIR BP
n_iir = 8;

% Ganho topo 20 dB
IIR_num = [0.647375508078680 0.476938020848489 -1.18514858534853 -0.163723590164326 1.73997429824646 -0.163723590164326 -1.18514858534853 0.476938020848489 0.647375508078680];
IIR_den = [1 2.09183633896532 2.76979262441331 2.67833628318659 2.24039765311534 1.31221211034448 0.589222836584441 0.181903881186868 0.0448683229545886];

% Ganho topo 1 dB
% Amin_a2 = -Gs2+100;
% mv2 = [Gs2 Gs2 Gtopo2 Gtopo2 Gs2 Gs2 -Amin_a2 -Amin_a2 Gp2 Gp2 -Amin_a2];

% IIR_num_2 = [0.0726367266927389 0.0535133260950259 -0.132975858385091 -0.0183700889568945 0.195228327264364 -0.0183700889568945 -0.132975858385091 0.0535133260950259 0.0726367266927389];
% IIR_den_2 = [1 2.09183633896532 2.76979262441331 2.67833628318659 2.24039765311534 1.31221211034448 0.589222836584441 0.181903881186868 0.0448683229545886];

% Ganho topo 0 dB
Amin_a3 = -Gs3+100;
mv3 = [Gs3 Gs3 Gtopo3 Gtopo3 Gs3 Gs3 -Amin_a3 -Amin_a3 Gp3 Gp3 -Amin_a3];

IIR_den_3 = [1 2.09183633896532 2.76979262441331 2.67833628318659 2.24039765311534 1.31221211034448 0.589222836584441 0.181903881186868 0.0448683229545886];
IIR_num_3 = [0.0647375508078680 0.0476938020848489 -0.118514858534853 -0.0163723590164326 0.173997429824646 -0.0163723590164326 -0.118514858534853 0.0476938020848489 0.0647375508078680];



